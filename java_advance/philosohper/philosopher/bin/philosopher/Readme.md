The main problem in this program is that it cannot stop correctly. 